# -*- coding: utf-8 -*-
from datetime import datetime, timedelta
from typing import Dict, Optional


def _sync_interval(delta: Optional[Dict[str, int]], **context) -> str:
    if not isinstance(delta, dict):
        delta = {"days": -10}
    templates_dict: Dict[str, str] = context.get("templates_dict", {})
    if "polling_interval.start_date" in templates_dict:
        start_datetime = datetime.fromisoformat(
            templates_dict["polling_interval.start_date"]
        ).replace(tzinfo=None)
    else:
        start_datetime = datetime.now()
    return (start_datetime + timedelta(**delta)).isoformat()


COLUMNS = [
    (
        "account",
        [
            "id",
            "accountnumber",
            "billingcity",
            "billingcountry",
            "billingpostalcode",
            "billingstate",
            "billingstreet",
            "createdbyid",
            "createddate",
            "fax",
            "iscustomerportal",
            "isdeleted",
            "ispartner",
            "lastmodifiedbyid",
            "lastmodifieddate",
            "name",
            "phone",
            "recordtypeid",
            "sales_person__c",
            "shippingcity",
            "shippingcountry",
            "shippingpostalcode",
            "shippingstate",
            "shippingstreet",
            "solution_type__c",
            "source_erp__c",
            "systemmodstamp",
            "type",
            "parentid",
        ],
    ),
    (
        "accounts_supported__c",
        [
            "id",
            "account__c",
            "account_group__c",
            "contact__c",
            "createdbyid",
            "createddate",
            "lastmodifiedbyid",
            "lastmodifieddate",
            "systemmodstamp",
        ],
    ),
    (
        "attachment",
        [
            "id",
            "ownerid",
            "createdbyid",
            "name",
            "parentid",
            "createddate",
            "systemmodstamp",
            "isdeleted",
            "description",
            "parent_recordtypeid",
            "parent_type",
            "lastmodifiedbyid",
        ],
    ),
    (
        "case",
        [
            "id",
            "accountid",
            "advance_approval__c",
            "casenumber",
            "closeddate",
            "contactid",
            "createdbyid",
            "createddate",
            "description",
            "division__c",
            "invoice_to1__c",
            "isdeleted",
            "last_status_change__c",
            "lastmodifiedbyid",
            "lastmodifieddate",
            "order_entry_date__c",
            "ownerid",
            "recordtypeid",
            "replacement_order__c",
            "request_for_special_investigation__c",
            "return_type__c",
            "rma_approval_date__c",
            "rma_date_sent_to_approval__c",
            "rma_received_date__c",
            "ship_date__c",
            "ship_to__c",
            "ship_to_name__c",
            "shipped_via__c",
            "shipping_account_address__c",
            "shipping_city__c",
            "shipping_country__c",
            "shipping_state_province__c",
            "shipping_street__c",
            "shipping_zip_postalcode__c",
            "shipto_number__c",
            "special_investigation__c",
            "status",
            "subject",
            "systemmodstamp",
            "tracking_number__c",
            "response_due_date__c",
            "priority",
            "claimed_time__c",
            "family__c",
            "market__c",
            "group__c",
            "product_type__c",
            "isescalated",
            "resolution_comments__c",
            "queue_order__c",
            "resolution_due_date__c",
            "origin",
            "time_to_claim_hrs__c",
            "time_to_resolve_hrs__c",
            "time_to_claim_weekdays__c",
            "time_to_resolve_weekdays__c",
            "pass_fail_resolution__c",
            "pass_fail_response__c",
            "article_attached__c",
            "severity_changed__c",
            "isclosed",
            "ship_to_phone__c",
            "tag__c",
        ],
    ),
    (
        "contact",
        [
            "id",
            "accountid",
            "createdbyid",
            "createddate",
            "email",
            "fax",
            "firstname",
            "hasoptedoutofemail",
            "isdeleted",
            "lastmodifiedbyid",
            "lastmodifieddate",
            "lastname",
            "mailingcity",
            "mailingcountry",
            "mailingpostalcode",
            "mailingstate",
            "mailingstreet",
            "name",
            "ownerid",
            "phone",
            "systemmodstamp",
            "title",
        ],
    ),
    (
        "note",
        [
            "id",
            "ownerid",
            "createdbyid",
            "parentid",
            "createddate",
            "systemmodstamp",
            "isdeleted",
            "parent_recordtypeid",
            "parent_type",
            "title",
            "body",
            "isprivate",
            "lastmodifiedbyid",
        ],
    ),
    (
        "ps_engagement__c",
        [
            "id",
            "name",
            "integration_status__c",
            "accountps__c",
            "engagement_status__c",
            "engagement_type__c",
            "commodity_type__c",
            "sa_applications__c",
            "integration_type__c",
            "integration_target_system__c",
            "integration_with__c",
            "integration_signoff_received_date__c",
            "integration_comments__c",
            "kickoff_meeting_date__c",
            "primary_contact__c",
            "saas_managed__c",
            "var_direct__c",
            "createdbyid",
            "lastmodifiedbyid",
            "createddate",
            "systemmodstamp",
            "isdeleted",
            "var_direct_primary_contact__c",
            "utility_primary_contact__c",
            "integration_overview_requested__c",
            "data_sync__c",
            "sensus_analytics_training_ordered__c",
            "cis_vendor_contact__c",
        ],
    ),
    (
        "ps_engagement__history",
        [
            "id",
            "oldvalue",
            "newvalue",
            "parent_id",
            "field",
            "isdeleted",
            "createddate",
            "createdbyid",
        ],
    ),
    (
        "rma_item__c",
        [
            "id",
            "createdbyid",
            "createddate",
            "customer_sn__c",
            "date_physically_received__c",
            "entered_receive_date__c",
            "in_warranty__c",
            "isdeleted",
            "item_status__c",
            "last_disposition__c",
            "lastmodifiedbyid",
            "lastmodifieddate",
            "manufacture_date__c",
            "name",
            "problem_sub_type1__c",
            "problem_type__c",
            "product_description__c",
            "product_number__c",
            "quantity__c",
            "rma_part_sub_type__c",
            "rma_part_type__c",
            "serial_number__c",
            "systemmodstamp",
            "case1__c",
        ],
    ),
    (
        "ship_to_location__c",
        [
            "id",
            "account__c",
            "account_number__c",
            "createdbyid",
            "createddate",
            "isdeleted",
            "lastmodifiedbyid",
            "name",
            "salesman__c",
            "shipping_city__c",
            "shipping_country__c",
            "shipping_phone__c",
            "shipping_postal_code__c",
            "shipping_state__c",
            "shipping_street__c",
            "ship_to_account_name__c",
            "ship_to_number__c",
            "systemmodstamp",
        ],
    ),
    (
        "user",
        [
            "id",
            "accountid",
            "contactid",
            "country",
            "createdbyid",
            "createddate",
            "email",
            "firstname",
            "fullphotourl",
            "isactive",
            "isportalenabled",
            "lastlogindate",
            "lastmodifiedbyid",
            "lastmodifieddate",
            "lastname",
            "name",
            "profileid",
            "smallphotourl",
            "systemmodstamp",
            "title",
            "username",
            "usertype",
            "phone",
        ],
    ),
]
